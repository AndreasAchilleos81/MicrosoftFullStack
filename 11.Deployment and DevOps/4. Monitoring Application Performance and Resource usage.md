# Monitoring Azure Applications with CLI

## Introduction

Once you've deployed an app to cloud services like Azure, monitoring is essential. This guide demonstrates how to monitor application performance and resource usage on Azure using open source tools, specifically the Azure Command Line Interface (CLI).

## Setup

### Installation
- The Azure CLI can be installed from Azure.com or Microsoft's developer portal
- Works with Visual Studio Code terminal or standalone terminal/PowerShell windows
- All Azure CLI commands start with `az`

### Authentication

```bash
az login
```

**What it does:** Opens a browser window for Azure account authentication. After login, retrieves all available subscriptions and allows you to select the active subscription.

---

## Basic Azure CLI Commands

### 1. List Account Users

```bash
az account list
```

**What it does:** 
- Shows all users on your Azure account
- Provides information about each user
- Helps identify unexpected account access
- Returns data needed for other Azure CLI commands

**Use case:** Account security and user management

---

### 2. List Resource Groups

```bash
az group list
```

**What it does:**
- Lists all resource groups in your subscription
- Resource groups are containers for organizing Azure resources
- Returns JSON data including:
  - Location (e.g., Central US)
  - Provisioning status
  - Resource group IDs

**Use case:** Useful for automation scripts that need resource group IDs for subsequent commands

---

### 3. List Log Analytics Workspaces

```bash
az monitor log-analytics workspace list --output table
```

**What it does:**
- Displays available log analytics workspaces in table format
- Shows workspace names, locations, and other metadata
- Log analytics helps evaluate performance of applications and workspaces

**Use case:** Performance analysis and workspace monitoring

---

## Advanced Monitoring Commands

### 4. List Metric Definitions for a Web App

```bash
az monitor metrics list-definitions \
  --resource <subscription-id> \
  --resource-group <resource-group-name> \
  --resource-name <app-name> \
  --resource-type Microsoft.Web/sites
```

**What it does:**
- Retrieves all available metrics for a specific web application
- Returns health check status, app metrics, and function app data
- Lists everything you can evaluate for the app
- Returns data in JSON format

**Use case:** Determining if an app is functioning well or poorly; can feed data into AI tools (Microsoft Copilot, ChatGPT) for analysis

---

### 5. Get Specific Metrics (CPU Time)

```bash
az monitor metrics list \
  --resource <subscription-id> \
  --resource-group <resource-group-name> \
  --resource-name <app-name> \
  --resource-type Microsoft.Web/sites \
  --metric "CPU time"
```

**What it does:**
- Drills down into specific metric data (e.g., CPU time)
- Returns timestamped CPU usage data
- Shows CPU processing during specific time periods

**Use case:** 
- Identify performance bottlenecks
- Detect bugs causing high CPU usage
- Determine if you need to scale up your app service plan
- Analyze trends over time using automated tools

---

### 6. Query Log Analytics

```bash
az monitor log-analytics query \
  --workspace <workspace-id> \
  --analytics-query "AzureDiagnostics | take 10"
```

**What it does:**
- Queries log data from a specific workspace
- Retrieves historical app log information
- Returns an array of log entries with error and diagnostic data

**Use case:** 
- Analyze historical app performance
- Compare historical data with current metrics
- Debug issues using error logs

---

## Key Benefits

### Automation
- Chain commands together in scripts
- Extract IDs and use them programmatically
- Automate repetitive monitoring tasks

### Data Analysis
- All data returned in JSON format
- Can be analyzed by external tools
- Create charts and perform trend analysis
- More detailed than Azure Portal snapshots

### Flexibility
- Works alongside Azure Portal
- Provides programmatic access to all monitoring data
- Enables custom analytics and reporting

---

## Best Practices

1. **Start broad, then drill down** - Use list commands to get overview, then use specific metrics for detailed analysis
2. **Automate data collection** - Script regular data pulls for trend analysis
3. **Leverage AI tools** - Feed JSON output to tools like Copilot or ChatGPT for automated analysis
4. **Monitor CPU patterns** - Sustained high CPU usage (near 100%) indicates either bugs or need for scaling
5. **Combine real-time and historical data** - Use metrics for current state, logs for historical analysis

---

## Summary

The Azure CLI provides powerful monitoring capabilities that complement the Azure Portal. It's particularly valuable for automation and detailed data analysis, giving you programmatic access to performance metrics, resource information, and historical logs.


# Monitoring Application Performance and Resource Usage on Azure

## Introduction

Application management extends beyond deploymentâ€”continuous monitoring is essential for ensuring performance and reliability. Without proper monitoring tools, minor issues like slow response times or high resource usage can escalate into major failures, impacting users and business operations.

---

## Azure Monitor

### Overview

**Azure Monitor** is a comprehensive cloud-based service that collects, analyzes, and visualizes data transmitted from applications and infrastructure to enhance performance and reliability.

### Key Capabilities

- **Metrics collection** - Gathers performance data in real-time
- **Log analysis** - Analyzes application and system logs
- **Alerts** - Notifies teams of potential issues
- **Dashboards** - Visualizes data for quick insights
- **Proactive issue detection** - Identifies problems before they impact users

### Real-World Example

A company's website suddenly slows down. Developers check Azure Monitor and notice CPU usage has spiked. With this insight, they quickly scale up resources, preventing a crash and keeping the site running smoothly.

---

## Application Insights

### Overview

**Application Insights** is a feature of Azure Monitor that helps developers track application performance, detect anomalies, and diagnose issues in real-time.

### Key Features

- **Performance metrics** - Monitors response times, throughput, and resource usage
- **Dependency tracking** - Traces calls to external services and databases
- **Failure diagnostics** - Identifies and analyzes errors and exceptions
- **Real-time analytics** - Provides immediate insights into application behavior
- **In-depth visualizations** - Creates charts and graphs for easy understanding

### Benefits

- Identify performance bottlenecks
- Optimize resource usage
- Enhance overall application reliability
- Improve user experience

### Real-World Example

A retail company launches a new checkout system, but customers begin reporting delays when placing orders. Using Application Insights, developers analyze transaction logs and trace the issue to a slow API request. By optimizing the query, they instantly improve checkout speed, enhancing the shopping experience.

---

## Azure Monitor Autoscale

### Overview

**Autoscaling** is the process of automatically adjusting computing resources based on demand to ensure optimal performance and cost efficiency. In Azure, this is implemented using **Azure Monitor Autoscale**.

### How It Works

1. **Monitors key performance indicators:**
   - CPU usage
   - Memory utilization
   - Request rates
   - Custom metrics

2. **Automatically scales resources:**
   - **Scale up/out** - Increases instances when demand rises
   - **Scale down/in** - Decreases instances when demand drops

3. **Maintains balance:**
   - Ensures application performance
   - Optimizes financial cost efficiency

### Real-World Example

A live stream concert attracts millions of viewers. As the audience grows, platform traffic spikes dramatically. Instead of servers struggling to keep up, Azure Monitor Autoscale increases the number of instances to handle the demand. Once the concert ends and traffic decreases, the system scales down to reduce costs.

---

## Key Benefits of Azure Monitoring Tools

### 1. Proactive Issue Resolution
Detect and resolve performance issues before they affect users

### 2. Real-Time Insights
Monitor application behavior as it happens

### 3. Cost Optimization
Scale resources dynamically to match actual demand

### 4. Enhanced Reliability
Maintain consistent application performance under varying loads

### 5. Improved User Experience
Keep applications responsive and available

---

## Summary

Azure provides a comprehensive suite of monitoring tools that work together to ensure application performance and reliability:

- **Azure Monitor** - Central platform for collecting, analyzing, and visualizing data
- **Application Insights** - Deep application performance monitoring and diagnostics
- **Azure Monitor Autoscale** - Dynamic resource scaling based on demand

With these tools, developers can detect, analyze, and resolve performance issues proactively, keeping applications reactive and enabling a great user experience while optimizing costs.